/**
 * almond 0.2.5 Copyright (c) 2011-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/**
 * @license
 * Lo-Dash 1.2.1 (Custom Build) <http://lodash.com/>
 * Build: `lodash modern -o ./dist/lodash.js`
 * Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>
 * Based on Underscore.js 1.4.4 <http://underscorejs.org/>
 * Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud Inc.
 * Available under MIT license <http://lodash.com/license>
 */

(function(t,n){t.livestyle=n()})(this,function(){var t,n,e;return function(r){function i(t,n){return _.call(t,n)}function a(t,n){var e,r,i,a,u,o,c,s,l,f,h=n&&n.split("/"),p=y.map,v=p&&p["*"]||{};if(t&&"."===t.charAt(0))if(n){for(h=h.slice(0,h.length-1),t=h.concat(t.split("/")),s=0;t.length>s;s+=1)if(f=t[s],"."===f)t.splice(s,1),s-=1;else if(".."===f){if(1===s&&(".."===t[2]||".."===t[0]))break;s>0&&(t.splice(s-1,2),s-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((h||v)&&p){for(e=t.split("/"),s=e.length;s>0;s-=1){if(r=e.slice(0,s).join("/"),h)for(l=h.length;l>0;l-=1)if(i=p[h.slice(0,l).join("/")],i&&(i=i[r])){a=i,u=s;break}if(a)break;!o&&v&&v[r]&&(o=v[r],c=s)}!a&&o&&(a=o,u=c),a&&(e.splice(0,u,a),t=e.join("/"))}return t}function u(t,n){return function(){return p.apply(r,k.call(arguments,0).concat([t,n]))}}function o(t){return function(n){return a(n,t)}}function c(t){return function(n){g[t]=n}}function s(t){if(i(m,t)){var n=m[t];delete m[t],b[t]=!0,h.apply(r,n)}if(!i(g,t)&&!i(b,t))throw Error("No "+t);return g[t]}function l(t){var n,e=t?t.indexOf("!"):-1;return e>-1&&(n=t.substring(0,e),t=t.substring(e+1,t.length)),[n,t]}function f(t){return function(){return y&&y.config&&y.config[t]||{}}}var h,p,v,d,g={},m={},y={},b={},_=Object.prototype.hasOwnProperty,k=[].slice;v=function(t,n){var e,r=l(t),i=r[0];return t=r[1],i&&(i=a(i,n),e=s(i)),i?t=e&&e.normalize?e.normalize(t,o(n)):a(t,n):(t=a(t,n),r=l(t),i=r[0],t=r[1],i&&(e=s(i))),{f:i?i+"!"+t:t,n:t,pr:i,p:e}},d={require:function(t){return u(t)},exports:function(t){var n=g[t];return n!==void 0?n:g[t]={}},module:function(t){return{id:t,uri:"",exports:g[t],config:f(t)}}},h=function(t,n,e,a){var o,l,f,h,p,y,_=[];if(a=a||t,"function"==typeof e){for(n=!n.length&&e.length?["require","exports","module"]:n,p=0;n.length>p;p+=1)if(h=v(n[p],a),l=h.f,"require"===l)_[p]=d.require(t);else if("exports"===l)_[p]=d.exports(t),y=!0;else if("module"===l)o=_[p]=d.module(t);else if(i(g,l)||i(m,l)||i(b,l))_[p]=s(l);else{if(!h.p)throw Error(t+" missing "+l);h.p.load(h.n,u(a,!0),c(l),{}),_[p]=g[l]}f=e.apply(g[t],_),t&&(o&&o.exports!==r&&o.exports!==g[t]?g[t]=o.exports:f===r&&y||(g[t]=f))}else t&&(g[t]=e)},t=n=p=function(t,n,e,i,a){return"string"==typeof t?d[t]?d[t](n):s(v(t,n).f):(t.splice||(y=t,n.splice?(t=n,n=e,e=null):t=r),n=n||function(){},"function"==typeof e&&(e=i,i=a),i?h(r,t,n,e):setTimeout(function(){h(r,t,n,e)},4),p)},p.config=function(t){return y=t,y.deps&&p(y.deps,y.callback),p},e=function(t,n,e){n.splice||(e=n,n=[]),i(g,t)||i(m,t)||(m[t]=[t,n,e])},e.amd={jQuery:!0}}(),e("backend/almond",function(){}),function(t){function n(e){function i(t){return t&&"object"==typeof t&&!yr(t)&&Ze.call(t,"__wrapped__")?t:new F(t)}function u(t){var n=t.length,e=n>=l;if(e)for(var r={},i=-1;n>++i;){var a=s+t[i];(r[a]||(r[a]=[])).push(t[i])}return function(n){if(e){var i=s+n;return r[i]&&Kn(r[i],n)>-1}return Kn(t,n)>-1}}function T(t){return t.charCodeAt(0)}function B(t,n){var e=t.index,i=n.index;if(t=t.criteria,n=n.criteria,t!==n){if(t>n||t===r)return 1;if(n>t||n===r)return-1}return i>e?-1:1}function J(t,n,e,r){function i(){var r=arguments,s=u?this:n;if(a||(t=n[o]),e.length&&(r=r.length?(r=pr.call(r),c?r.concat(e):e.concat(r)):e),this instanceof i){M.prototype=t.prototype,s=new M,M.prototype=null;var l=t.apply(s,r);return cn(l)?l:s}return t.apply(s,r)}var a=on(t),u=!e,o=n;if(u){var c=r;e=n}else if(!a){if(!r)throw new Me;n=t}return i}function z(t){return"\\"+q[t]}function U(t){return kr[t]}function F(t){this.__wrapped__=t}function M(){}function D(t){var n=!1;if(!t||rr.call(t)!=A)return n;var e=t.constructor;return(on(e)?e instanceof e:!0)?(wr(t,function(t,e){n=e}),n===!1||Ze.call(t,n)):n}function V(t,n,e){n||(n=0),e===r&&(e=t?t.length:0);for(var i=-1,a=e-n||0,u=Le(0>a?0:a);a>++i;)u[i]=t[n+i];return u}function K(t){return xr[t]}function Q(t){return rr.call(t)==w}function G(t,n,e,a,u,o){var c=t;if("function"==typeof n&&(a=e,e=n,n=!1),"function"==typeof e){if(e=a===r?e:i.createCallback(e,a,1),c=e(c),c!==r)return c;c=t}var s=cn(c);if(s){var l=rr.call(c);if(!L[l])return c;var f=yr(c)}if(!s||!n)return s?f?V(c):Cr({},c):c;var h=gr[l];switch(l){case j:case R:return new h(+c);case N:case E:return new h(c);case P:return h(c.source,g.exec(c))}u||(u=[]),o||(o=[]);for(var p=u.length;p--;)if(u[p]==t)return o[p];return c=f?h(c.length):{},f&&(Ze.call(t,"index")&&(c.index=t.index),Ze.call(t,"input")&&(c.input=t.input)),u.push(t),o.push(c),(f?On:Or)(t,function(t,i){c[i]=G(t,n,e,r,u,o)}),c}function H(t,n,e){return G(t,!0,n,e)}function W(t,n,e){var a;return n=i.createCallback(n,e),Or(t,function(t,e,i){return n(t,e,i)?(a=e,!1):r}),a}function X(t){var n=[];return wr(t,function(t,e){on(t)&&n.push(e)}),n.sort()}function Y(t,n){return t?Ze.call(t,n):!1}function Z(t){for(var n=-1,e=_r(t),r=e.length,i={};r>++n;){var a=e[n];i[t[a]]=a}return i}function tn(t){return t===!0||t===!1||rr.call(t)==j}function nn(t){return t?"object"==typeof t&&rr.call(t)==R:!1}function en(t){return t?1===t.nodeType:!1}function rn(t){var n=!0;if(!t)return n;var e=rr.call(t),r=t.length;return e==O||e==E||e==w||e==A&&"number"==typeof r&&on(t.splice)?!r:(Or(t,function(){return n=!1}),n)}function an(t,n,e,a,u,o){var s=e===c;if("function"==typeof e&&!s){e=i.createCallback(e,a,2);var l=e(t,n);if(l!==r)return!!l}if(t===n)return 0!==t||1/t==1/n;var f=typeof t,h=typeof n;if(t===t&&(!t||"function"!=f&&"object"!=f)&&(!n||"function"!=h&&"object"!=h))return!1;if(null==t||null==n)return t===n;var p=rr.call(t),v=rr.call(n);if(p==w&&(p=A),v==w&&(v=A),p!=v)return!1;switch(p){case j:case R:return+t==+n;case N:return t!=+t?n!=+n:0==t?1/t==1/n:t==+n;case P:case E:return t==Fe(n)}var d=p==O;if(!d){if(Ze.call(t,"__wrapped__ ")||Ze.call(n,"__wrapped__"))return an(t.__wrapped__||t,n.__wrapped__||n,e,a,u,o);if(p!=A)return!1;var g=t.constructor,m=n.constructor;if(g!=m&&!(on(g)&&g instanceof g&&on(m)&&m instanceof m))return!1}u||(u=[]),o||(o=[]);for(var y=u.length;y--;)if(u[y]==t)return o[y]==n;var b=0;if(l=!0,u.push(t),o.push(n),d){if(y=t.length,b=n.length,l=b==t.length,!l&&!s)return l;for(;b--;){var _=y,k=n[b];if(s)for(;_--&&!(l=an(t[_],k,e,a,u,o)););else if(!(l=an(t[b],k,e,a,u,o)))break}return l}return wr(n,function(n,i,c){return Ze.call(c,i)?(b++,l=Ze.call(t,i)&&an(t[i],n,e,a,u,o)):r}),l&&!s&&wr(t,function(t,n,e){return Ze.call(e,n)?l=--b>-1:r}),l}function un(t){return ur(t)&&!or(parseFloat(t))}function on(t){return"function"==typeof t}function cn(t){return t?$[typeof t]:!1}function sn(t){return fn(t)&&t!=+t}function ln(t){return null===t}function fn(t){return"number"==typeof t||rr.call(t)==N}function hn(t){return t?"object"==typeof t&&rr.call(t)==P:!1}function pn(t){return"string"==typeof t||rr.call(t)==E}function vn(t){return t===r}function dn(t,n,e){var a=arguments,u=0,o=2;if(!cn(t))return t;if(e===c)var s=a[3],l=a[4],f=a[5];else l=[],f=[],"number"!=typeof e&&(o=a.length),o>3&&"function"==typeof a[o-2]?s=i.createCallback(a[--o-1],a[o--],2):o>2&&"function"==typeof a[o-1]&&(s=a[--o]);for(;o>++u;)(yr(a[u])?On:Or)(a[u],function(n,e){var i,a,u=n,o=t[e];if(n&&((a=yr(n))||jr(n))){for(var h=l.length;h--;)if(i=l[h]==n){o=f[h];break}if(!i){var p;s&&(u=s(o,n),(p=u!==r)&&(o=u)),p||(o=a?yr(o)?o:[]:jr(o)?o:{}),l.push(n),f.push(o),p||(o=dn(o,n,c,s,l,f))}}else s&&(u=s(o,n),u===r&&(u=n)),u!==r&&(o=u);t[e]=o});return t}function gn(t,n,e){var r="function"==typeof n,a={};if(r)n=i.createCallback(n,e);else var u=We.apply(De,pr.call(arguments,1));return wr(t,function(t,e,i){(r?!n(t,e,i):0>Kn(u,e))&&(a[e]=t)}),a}function mn(t){for(var n=-1,e=_r(t),r=e.length,i=Le(r);r>++n;){var a=e[n];i[n]=[a,t[a]]}return i}function yn(t,n,e){var r={};if("function"!=typeof n)for(var a=-1,u=We.apply(De,pr.call(arguments,1)),o=cn(t)?u.length:0;o>++a;){var c=u[a];c in t&&(r[c]=t[c])}else n=i.createCallback(n,e),wr(t,function(t,e,i){n(t,e,i)&&(r[e]=t)});return r}function bn(t){for(var n=-1,e=_r(t),r=e.length,i=Le(r);r>++n;)i[n]=t[e[n]];return i}function _n(t){for(var n=-1,e=We.apply(De,pr.call(arguments,1)),r=e.length,i=Le(r);r>++n;)i[n]=t[e[n]];return i}function kn(t,n,e){var i=-1,a=t?t.length:0,u=!1;return e=(0>e?sr(0,a+e):e)||0,"number"==typeof a?u=(pn(t)?t.indexOf(n,e):Kn(t,n,e))>-1:Or(t,function(t){return++i>=e?!(u=t===n):r}),u}function xn(t,n,e){var r={};return n=i.createCallback(n,e),On(t,function(t,e,i){e=Fe(n(t,e,i)),Ze.call(r,e)?r[e]++:r[e]=1}),r}function Cn(t,n,e){var r=!0;n=i.createCallback(n,e);var a=-1,u=t?t.length:0;if("number"==typeof u)for(;u>++a&&(r=!!n(t[a],a,t)););else Or(t,function(t,e,i){return r=!!n(t,e,i)});return r}function Sn(t,n,e){var r=[];n=i.createCallback(n,e);var a=-1,u=t?t.length:0;if("number"==typeof u)for(;u>++a;){var o=t[a];n(o,a,t)&&r.push(o)}else Or(t,function(t,e,i){n(t,e,i)&&r.push(t)});return r}function wn(t,n,e){n=i.createCallback(n,e);var a=-1,u=t?t.length:0;if("number"!=typeof u){var o;return Or(t,function(t,e,i){return n(t,e,i)?(o=t,!1):r}),o}for(;u>++a;){var c=t[a];if(n(c,a,t))return c}}function On(t,n,e){var a=-1,u=t?t.length:0;if(n=n&&e===r?n:i.createCallback(n,e),"number"==typeof u)for(;u>++a&&n(t[a],a,t)!==!1;);else Or(t,n);return t}function jn(t,n,e){var r={};return n=i.createCallback(n,e),On(t,function(t,e,i){e=Fe(n(t,e,i)),(Ze.call(r,e)?r[e]:r[e]=[]).push(t)}),r}function Rn(t,n){var e=pr.call(arguments,2),r=-1,i="function"==typeof n,a=t?t.length:0,u=Le("number"==typeof a?a:0);return On(t,function(t){u[++r]=(i?n:t[n]).apply(t,e)}),u}function Tn(t,n,e){var r=-1,a=t?t.length:0;if(n=i.createCallback(n,e),"number"==typeof a)for(var u=Le(a);a>++r;)u[r]=n(t[r],r,t);else u=[],Or(t,function(t,e,i){u[++r]=n(t,e,i)});return u}function Nn(t,n,e){var r=-1/0,a=r;if(!n&&yr(t))for(var u=-1,o=t.length;o>++u;){var c=t[u];c>a&&(a=c)}else n=!n&&pn(t)?T:i.createCallback(n,e),On(t,function(t,e,i){var u=n(t,e,i);u>r&&(r=u,a=t)});return a}function An(t,n,e){var r=1/0,a=r;if(!n&&yr(t))for(var u=-1,o=t.length;o>++u;){var c=t[u];a>c&&(a=c)}else n=!n&&pn(t)?T:i.createCallback(n,e),On(t,function(t,e,i){var u=n(t,e,i);r>u&&(r=u,a=t)});return a}function Pn(t,n){var e=-1,r=t?t.length:0;if("number"==typeof r)for(var i=Le(r);r>++e;)i[e]=t[e][n];return i||Tn(t,n)}function En(t,n,e,r){if(!t)return e;var a=3>arguments.length;n=i.createCallback(n,r,4);var u=-1,o=t.length;if("number"==typeof o)for(a&&(e=t[++u]);o>++u;)e=n(e,t[u],u,t);else Or(t,function(t,r,i){e=a?(a=!1,t):n(e,t,r,i)});return e}function Ln(t,n,e,r){var a=t,u=t?t.length:0,o=3>arguments.length;if("number"!=typeof u){var c=_r(t);u=c.length}return n=i.createCallback(n,r,4),On(t,function(t,r,i){r=c?c[--u]:--u,e=o?(o=!1,a[r]):n(e,a[r],r,i)}),e}function $n(t,n,e){return n=i.createCallback(n,e),Sn(t,function(t,e,r){return!n(t,e,r)})}function qn(t){var n=-1,e=t?t.length:0,r=Le("number"==typeof e?e:0);return On(t,function(t){var e=Xe(hr()*(++n+1));r[n]=r[e],r[e]=t}),r}function In(t){var n=t?t.length:0;return"number"==typeof n?n:_r(t).length}function Bn(t,n,e){var r;n=i.createCallback(n,e);var a=-1,u=t?t.length:0;if("number"==typeof u)for(;u>++a&&!(r=n(t[a],a,t)););else Or(t,function(t,e,i){return!(r=n(t,e,i))});return!!r}function Jn(t,n,e){var r=-1,a=t?t.length:0,u=Le("number"==typeof a?a:0);for(n=i.createCallback(n,e),On(t,function(t,e,i){u[++r]={criteria:n(t,e,i),index:r,value:t}}),a=u.length,u.sort(B);a--;)u[a]=u[a].value;return u}function zn(t){return t&&"number"==typeof t.length?V(t):bn(t)}function Un(t){for(var n=-1,e=t?t.length:0,r=[];e>++n;){var i=t[n];i&&r.push(i)}return r}function Fn(t){for(var n=-1,e=t?t.length:0,r=We.apply(De,pr.call(arguments,1)),i=u(r),a=[];e>++n;){var o=t[n];i(o)||a.push(o)}return a}function Mn(t,n,e){var r=-1,a=t?t.length:0;for(n=i.createCallback(n,e);a>++r;)if(n(t[r],r,t))return r;return-1}function Dn(t,n,e){if(t){var r=0,a=t.length;if("number"!=typeof n&&null!=n){var u=-1;for(n=i.createCallback(n,e);a>++u&&n(t[u],u,t);)r++}else if(r=n,null==r||e)return t[0];return V(t,0,lr(sr(0,r),a))}}function Vn(t,n,e,r){var a=-1,u=t?t.length:0,o=[];for("boolean"!=typeof n&&null!=n&&(r=e,e=n,n=!1),null!=e&&(e=i.createCallback(e,r));u>++a;){var c=t[a];e&&(c=e(c,a,t)),yr(c)?tr.apply(o,n?c:Vn(c)):o.push(c)}return o}function Kn(t,n,e){var r=-1,i=t?t.length:0;if("number"==typeof e)r=(0>e?sr(0,i+e):e||0)-1;else if(e)return r=Zn(t,n),t[r]===n?r:-1;for(;i>++r;)if(t[r]===n)return r;return-1}function Qn(t,n,e){if(!t)return[];var r=0,a=t.length;if("number"!=typeof n&&null!=n){var u=a;for(n=i.createCallback(n,e);u--&&n(t[u],u,t);)r++}else r=null==n||e?1:n||r;return V(t,0,lr(sr(0,a-r),a))}function Gn(t){var n=arguments,e=n.length,r={0:{}},i=-1,a=t?t.length:0,o=a>=l,c=[],f=c;t:for(;a>++i;){var h=t[i];if(o)var p=s+h,v=r[0][p]?!(f=r[0][p]):f=r[0][p]=[];if(v||0>Kn(f,h)){o&&f.push(h);for(var d=e;--d;)if(!(r[d]||(r[d]=u(n[d])))(h))continue t;c.push(h)}}return c}function Hn(t,n,e){if(t){var r=0,a=t.length;if("number"!=typeof n&&null!=n){var u=a;for(n=i.createCallback(n,e);u--&&n(t[u],u,t);)r++}else if(r=n,null==r||e)return t[a-1];return V(t,sr(0,a-r))}}function Wn(t,n,e){var r=t?t.length:0;for("number"==typeof e&&(r=(0>e?sr(0,r+e):lr(e,r-1))+1);r--;)if(t[r]===n)return r;return-1}function Xn(t,n,e){t=+t||0,e=+e||1,null==n&&(n=t,t=0);for(var r=-1,i=sr(0,Ge((n-t)/e)),a=Le(i);i>++r;)a[r]=t,t+=e;return a}function Yn(t,n,e){if("number"!=typeof n&&null!=n){var r=0,a=-1,u=t?t.length:0;for(n=i.createCallback(n,e);u>++a&&n(t[a],a,t);)r++}else r=null==n||e?1:sr(0,n);return V(t,r)}function Zn(t,n,e,r){var a=0,u=t?t.length:a;for(e=e?i.createCallback(e,r,1):xe,n=e(n);u>a;){var o=a+u>>>1;n>e(t[o])?a=o+1:u=o}return a}function te(t){return yr(t)||(arguments[0]=t?pr.call(t):De),ne(We.apply(De,arguments))}function ne(t,n,e,r){var a=-1,u=t?t.length:0,o=[],c=o;"boolean"!=typeof n&&null!=n&&(r=e,e=n,n=!1);var f=!n&&u>=l;if(f)var h={};for(null!=e&&(c=[],e=i.createCallback(e,r));u>++a;){var p=t[a],v=e?e(p,a,t):p;if(f)var d=s+v,g=h[d]?!(c=h[d]):c=h[d]=[];(n?!a||c[c.length-1]!==v:g||0>Kn(c,v))&&((e||f)&&c.push(v),o.push(p))}return o}function ee(t){for(var n=-1,e=t?t.length:0,r=e?Nn(Pn(t,"length")):0,i=Le(r);e>++n;)for(var a=-1,u=t[n];r>++a;)(i[a]||(i[a]=Le(e)))[n]=u[a];return i}function re(t){return Fn(t,pr.call(arguments,1))}function ie(t){for(var n=-1,e=t?Nn(Pn(arguments,"length")):0,r=Le(e);e>++n;)r[n]=Pn(arguments,n);return r}function ae(t,n){for(var e=-1,r=t?t.length:0,i={};r>++e;){var a=t[e];n?i[a]=n[e]:i[a[0]]=a[1]}return i}function ue(t,n){return 1>t?n():function(){return 1>--t?n.apply(this,arguments):r}}function oe(t,n){return mr.fastBind||ir&&arguments.length>2?ir.call.apply(ir,arguments):J(t,n,pr.call(arguments,2))}function ce(t){for(var n=arguments.length>1?We.apply(De,pr.call(arguments,1)):X(t),e=-1,r=n.length;r>++e;){var i=n[e];t[i]=oe(t[i],t)}return t}function se(t,n){return J(t,n,pr.call(arguments,2),c)}function le(){var t=arguments;return function(){for(var n=arguments,e=t.length;e--;)n=[t[e].apply(this,n)];return n[0]}}function fe(t,n,e){if(null==t)return xe;var i=typeof t;if("function"!=i){if("object"!=i)return function(n){return n[t]};var a=_r(t);return function(n){for(var e=a.length,r=!1;e--&&(r=an(n[a[e]],t[a[e]],c)););return r}}return n!==r?1===e?function(e){return t.call(n,e)}:2===e?function(e,r){return t.call(n,e,r)}:4===e?function(e,r,i,a){return t.call(n,e,r,i,a)}:function(e,r,i){return t.call(n,e,r,i)}:t}function he(t,n,e){function r(){a=c=null,s&&(u=t.apply(o,i))}var i,a,u,o,c,s=!0;if(e===!0){var l=!0;s=!1}else e&&$[typeof e]&&(l=e.leading,s="trailing"in e?e.trailing:s);return function(){return i=arguments,o=this,He(c),!a&&l?(a=!0,u=t.apply(o,i)):c=er(r,n),u}}function pe(t){var n=pr.call(arguments,1);return er(function(){t.apply(r,n)},1)}function ve(t,n){var e=pr.call(arguments,2);return er(function(){t.apply(r,e)},n)}function de(t,n){var e={};return function(){var r=s+(n?n.apply(this,arguments):arguments[0]);return Ze.call(e,r)?e[r]:e[r]=t.apply(this,arguments)}}function ge(t){var n,e;return function(){return n?e:(n=!0,e=t.apply(this,arguments),t=null,e)}}function me(t){return J(t,pr.call(arguments,1))}function ye(t){return J(t,pr.call(arguments,1),null,c)}function be(t,n,e){function r(){o=null,l&&(c=new qe,a=t.apply(u,i))}var i,a,u,o,c=0,s=!0,l=!0;return e===!1?s=!1:e&&$[typeof e]&&(s="leading"in e?e.leading:s,l="trailing"in e?e.trailing:l),function(){var e=new qe;o||s||(c=e);var l=n-(e-c);return i=arguments,u=this,0>=l?(He(o),o=null,c=e,a=t.apply(u,i)):o||(o=er(r,l)),a}}function _e(t,n){return function(){var e=[t];return tr.apply(e,arguments),n.apply(this,e)}}function ke(t){return null==t?"":Fe(t).replace(k,U)}function xe(t){return t}function Ce(t){On(X(t),function(n){var e=i[n]=t[n];i.prototype[n]=function(){var t=this.__wrapped__,n=[t];tr.apply(n,arguments);var r=e.apply(i,n);return t&&"object"==typeof t&&t==r?this:new F(r)}})}function Se(){return e._=Ke,this}function we(t,n){return null==t&&null==n&&(n=1),t=+t||0,null==n&&(n=t,t=0),t+Xe(hr()*((+n||0)-t+1))}function Oe(t,n){var e=t?t[n]:r;return on(e)?t[n]():e}function je(t,n,e){var a=i.templateSettings;t||(t=""),e=Sr({},e,a);var u,o=Sr({},e.imports,a.imports),c=_r(o),s=bn(o),l=0,v=e.interpolate||_,g="__p += '",y=Ue((e.escape||_).source+"|"+v.source+"|"+(v===m?d:_).source+"|"+(e.evaluate||_).source+"|$","g");t.replace(y,function(n,e,r,i,a,o){return r||(r=i),g+=t.slice(l,o).replace(x,z),e&&(g+="' +\n__e("+e+") +\n'"),a&&(u=!0,g+="';\n"+a+";\n__p += '"),r&&(g+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),l=o+n.length,n}),g+="';\n";var b=e.variable,k=b;k||(b="obj",g="with ("+b+") {\n"+g+"\n}\n"),g=(u?g.replace(f,""):g).replace(h,"$1").replace(p,"$1;"),g="function("+b+") {\n"+(k?"":b+" || ("+b+" = {});\n")+"var __t, __p = '', __e = _.escape"+(u?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+g+"return __p\n}";var C="\n/*\n//@ sourceURL="+(e.sourceURL||"/lodash/template/source["+S++ +"]")+"\n*/";try{var w=Ie(c,"return "+g+C).apply(r,s)}catch(O){throw O.source=g,O}return n?w(n):(w.source=g,w)}function Re(t,n,e){t=(t=+t)>-1?t:0;var r=-1,a=Le(t);for(n=i.createCallback(n,e,1);t>++r;)a[r]=n(r);return a}function Te(t){return null==t?"":Fe(t).replace(v,K)}function Ne(t){var n=++o;return Fe(null==t?"":t)+n}function Ae(t,n){return n(t),t}function Pe(){return Fe(this.__wrapped__)}function Ee(){return this.__wrapped__}e=e?I.defaults(t.Object(),e,I.pick(t,C)):t;var Le=e.Array,$e=e.Boolean,qe=e.Date,Ie=e.Function,Be=e.Math,Je=e.Number,ze=e.Object,Ue=e.RegExp,Fe=e.String,Me=e.TypeError,De=Le(),Ve=ze(),Ke=e._,Qe=Ue("^"+Fe(Ve.valueOf).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),Ge=Be.ceil,He=e.clearTimeout,We=De.concat,Xe=Be.floor,Ye=Qe.test(Ye=ze.getPrototypeOf)&&Ye,Ze=Ve.hasOwnProperty,tr=De.push,nr=e.setImmediate,er=e.setTimeout,rr=Ve.toString,ir=Qe.test(ir=rr.bind)&&ir,ar=Qe.test(ar=Le.isArray)&&ar,ur=e.isFinite,or=e.isNaN,cr=Qe.test(cr=ze.keys)&&cr,sr=Be.max,lr=Be.min,fr=e.parseInt,hr=Be.random,pr=De.slice,vr=Qe.test(e.attachEvent),dr=ir&&!/\n|true/.test(ir+vr),gr={};gr[O]=Le,gr[j]=$e,gr[R]=qe,gr[A]=ze,gr[N]=Je,gr[P]=Ue,gr[E]=Fe;var mr=i.support={};mr.fastBind=ir&&!dr,i.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:m,variable:"",imports:{_:i}},F.prototype=i.prototype;var yr=ar,br=function(t){var n,e=t,r=[];if(!e)return r;if(!$[typeof t])return r;for(n in e)Ze.call(e,n)&&r.push(n);return r},_r=cr?function(t){return cn(t)?cr(t):[]}:br,kr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},xr=Z(kr),Cr=function(t,n,e){var r,a=t,u=a;if(!a)return u;var o=arguments,c=0,s="number"==typeof e?2:o.length;if(s>3&&"function"==typeof o[s-2])var l=i.createCallback(o[--s-1],o[s--],2);else s>2&&"function"==typeof o[s-1]&&(l=o[--s]);for(;s>++c;)if(a=o[c],a&&$[typeof a]){var f=a.length;if(r=-1,yr(a))for(;f>++r;)u[r]=l?l(u[r],a[r]):a[r];else for(var h=-1,p=$[typeof a]?_r(a):[],f=p.length;f>++h;)r=p[h],u[r]=l?l(u[r],a[r]):a[r]}return u},Sr=function(t,n,e){var i,a=t,u=a;if(!a)return u;for(var o=arguments,c=0,s="number"==typeof e?2:o.length;s>++c;)if(a=o[c],a&&$[typeof a]){var l=a.length;if(i=-1,yr(a))for(;l>++i;)u[i]===r&&(u[i]=a[i]);else for(var f=-1,h=$[typeof a]?_r(a):[],l=h.length;l>++f;)i=h[f],u[i]===r&&(u[i]=a[i])}return u},wr=function(t,n,e){var a,u=t,o=u;if(!u)return o;if(!$[typeof u])return o;n=n&&e===r?n:i.createCallback(n,e);for(a in u)if(n(u[a],a,t)===!1)return o;return o},Or=function(t,n,e){var a,u=t,o=u;if(!u)return o;if(!$[typeof u])return o;n=n&&e===r?n:i.createCallback(n,e);for(var c=-1,s=$[typeof u]?_r(u):[],l=s.length;l>++c;)if(a=s[c],n(u[a],a,t)===!1)return o;return o},jr=function(t){if(!t||rr.call(t)!=A)return!1;var n=t.valueOf,e="function"==typeof n&&(e=Ye(n))&&Ye(e);return e?t==e||Ye(t)==e:D(t)},Rr=Sn;dr&&a&&"function"==typeof nr&&(pe=oe(nr,e));var Tr=8==fr(y+"08")?fr:function(t,n){return fr(pn(t)?t.replace(b,""):t,n||0)};return i.after=ue,i.assign=Cr,i.at=_n,i.bind=oe,i.bindAll=ce,i.bindKey=se,i.compact=Un,i.compose=le,i.countBy=xn,i.createCallback=fe,i.debounce=he,i.defaults=Sr,i.defer=pe,i.delay=ve,i.difference=Fn,i.filter=Sn,i.flatten=Vn,i.forEach=On,i.forIn=wr,i.forOwn=Or,i.functions=X,i.groupBy=jn,i.initial=Qn,i.intersection=Gn,i.invert=Z,i.invoke=Rn,i.keys=_r,i.map=Tn,i.max=Nn,i.memoize=de,i.merge=dn,i.min=An,i.omit=gn,i.once=ge,i.pairs=mn,i.partial=me,i.partialRight=ye,i.pick=yn,i.pluck=Pn,i.range=Xn,i.reject=$n,i.rest=Yn,i.shuffle=qn,i.sortBy=Jn,i.tap=Ae,i.throttle=be,i.times=Re,i.toArray=zn,i.union=te,i.uniq=ne,i.unzip=ee,i.values=bn,i.where=Rr,i.without=re,i.wrap=_e,i.zip=ie,i.zipObject=ae,i.collect=Tn,i.drop=Yn,i.each=On,i.extend=Cr,i.methods=X,i.object=ae,i.select=Sn,i.tail=Yn,i.unique=ne,Ce(i),i.clone=G,i.cloneDeep=H,i.contains=kn,i.escape=ke,i.every=Cn,i.find=wn,i.findIndex=Mn,i.findKey=W,i.has=Y,i.identity=xe,i.indexOf=Kn,i.isArguments=Q,i.isArray=yr,i.isBoolean=tn,i.isDate=nn,i.isElement=en,i.isEmpty=rn,i.isEqual=an,i.isFinite=un,i.isFunction=on,i.isNaN=sn,i.isNull=ln,i.isNumber=fn,i.isObject=cn,i.isPlainObject=jr,i.isRegExp=hn,i.isString=pn,i.isUndefined=vn,i.lastIndexOf=Wn,i.mixin=Ce,i.noConflict=Se,i.parseInt=Tr,i.random=we,i.reduce=En,i.reduceRight=Ln,i.result=Oe,i.runInContext=n,i.size=In,i.some=Bn,i.sortedIndex=Zn,i.template=je,i.unescape=Te,i.uniqueId=Ne,i.all=Cn,i.any=Bn,i.detect=wn,i.foldl=En,i.foldr=Ln,i.include=kn,i.inject=En,Or(i,function(t,n){i.prototype[n]||(i.prototype[n]=function(){var n=[this.__wrapped__];return tr.apply(n,arguments),t.apply(i,n)})}),i.first=Dn,i.last=Hn,i.take=Dn,i.head=Dn,Or(i,function(t,n){i.prototype[n]||(i.prototype[n]=function(n,e){var r=t(this.__wrapped__,n,e);return null==n||e&&"function"!=typeof n?r:new F(r)})}),i.VERSION="1.2.1",i.prototype.toString=Pe,i.prototype.value=Ee,i.prototype.valueOf=Ee,On(["join","pop","shift"],function(t){var n=De[t];i.prototype[t]=function(){return n.apply(this.__wrapped__,arguments)}}),On(["push","reverse","sort","unshift"],function(t){var n=De[t];i.prototype[t]=function(){return n.apply(this.__wrapped__,arguments),this}}),On(["concat","slice","splice"],function(t){var n=De[t];i.prototype[t]=function(){return new F(n.apply(this.__wrapped__,arguments))}}),i}var r,i="object"==typeof exports&&exports,a="object"==typeof module&&module&&module.exports==i&&module,u="object"==typeof global&&global;(u.global===u||u.window===u)&&(t=u);var o=0,c={},s=+new Date+"",l=200,f=/\b__p \+= '';/g,h=/\b(__p \+=) '' \+/g,p=/(__e\(.*?\)|\b__t\)) \+\n'';/g,v=/&(?:amp|lt|gt|quot|#39);/g,d=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,g=/\w*$/,m=/<%=([\s\S]+?)%>/g,y=" 	\f\n\r\u2028\u2029",b=RegExp("^["+y+"]*0+(?=.$)"),_=/($^)/,k=/[&<>"']/g,x=/['\n\r\t\u2028\u2029\\]/g,C=["Array","Boolean","Date","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setImmediate","setTimeout"],S=0,w="[object Arguments]",O="[object Array]",j="[object Boolean]",R="[object Date]",T="[object Function]",N="[object Number]",A="[object Object]",P="[object RegExp]",E="[object String]",L={};L[T]=!1,L[w]=L[O]=L[j]=L[R]=L[N]=L[A]=L[P]=L[E]=!0;var $={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},q={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},I=n();e("lodash",[],function(){return I})}(this),e("cssParser",[],function(){function t(t,n){return n=n||t.charCodeAt(0),n>=97&&122>=n||n>=65&&90>=n||n>=1024&&1279>=n||"&"===t||"_"===t||"-"===t}function n(t,n){return n=n||t.charCodeAt(0),n>=48&&57>=n}function e(t,n){p.tokens.push({value:t,type:n||t,start:null,end:null})}function r(t){for(var n=t.chnum,e=t.source.replace(/\r\n?/g,"\n"),r=t.source.substring(0,n+1).replace(/\r\n?/g,"\n"),i=r.split("\n"),a=(i[i.length-1]||"").length,u=e.split("\n")[i.length-1]||"",o=100,c=Math.max(0,a-o),s=u.substr(c,2*o)+"\n",l=0;a-c-1>l;l++)s+="-";return s+="^",{line:i.length,ch:a,text:u,hint:s}}function i(t){var n=r(v);p.tokens,p.tokens=null;var e="CSS parsing error at line "+n.line+", char "+n.ch+": "+t;return e+="\n"+n.hint,{name:"ParseError",message:e,hint:n.hint,line:n.line,ch:n.ch}}function a(){for(var t=v.ch,n="";" "===t||"	"===t;)n+=t,t=v.nextChar();e(n,"white")}function u(){var t,n=v,r=n.ch,i=r;if(t=n.nextChar(),"/"===t){i+=t;for(var a=n.peek();a&&"\n"!==a;)i+=t,t=n.nextChar(),a=n.peek()}else{if("*"!==t)return e(i,i);for(;r&&("*"!==r||"/"!==t);)i+=t,r=t,t=n.nextChar()}i+=t,n.nextChar(),e(i,"comment")}function o(){var t,n=v,r=n.ch,a=r,u=r;for(r=n.nextChar();r!==a;){if("\n"===r){if(t=n.nextChar(),"\\"!==t)throw i("Unterminated string");u+=r+t}else u+="\\"===r?r+n.nextChar():r;r=n.nextChar()}u+=r,n.nextChar(),e(u,"string")}function c(){var t=v,n=t.ch,r=0,a=n;for(n=t.nextChar();")"!==n&&!r;){if("("===n)r++;else if(")"===n)r--;else if(""===n)throw i("Unterminated brace");a+=n,n=t.nextChar()}a+=n,t.nextChar(),e(a,"brace")}function s(r){var i=v.ch,a=r?r+i:i;i=v.nextChar();for(var u=i.charCodeAt(0);t(i,u)||n(i,u);)a+=i,i=v.nextChar(),u=i.charCodeAt(0);e(a,"identifier")}function l(){var t,r=v,i=r.ch,a=i,u="."===a;if(i=r.nextChar(),t=!n(i),u&&t)return e(a,".");if("-"===a&&t)return s("-");for(;""!==i&&(n(i)||!u&&"."===i);)"."===i&&(u=!0),a+=i,i=r.nextChar();e(a,"number")}function f(){var t=v,n=t.ch,r=n,i=t.nextChar();return"="===i&&d(r,!0)?(r+=i,e(r,"match"),t.nextChar(),void 0):(e(r,r),void 0)}function h(){var r=v.ch;if(" "===r||"	"===r)return a();if("/"===r)return u();if('"'===r||"'"===r)return o();if("("===r)return c();if("-"===r||"."===r||n(r))return l();if(t(r))return s();if(d(r))return f();if("\r"===r)return"\n"===v.peek()&&(r+=v.nextChar()),e(r,"line"),v.nextChar(),void 0;if("\n"===r)return e(r,"line"),v.nextChar(),void 0;throw i("Unrecognized character '"+r+"'")}var p={tokens:null},v={init:function(t){this.source=t,this.ch="",this.chnum=-1,this.nextChar()},nextChar:function(){return this.ch=this.source.charAt(++this.chnum)},peek:function(){return this.source.charAt(this.chnum+1)}},d=function(){for(var t="{}[]()+*=.,;:>~|\\%$#@^!".split(""),n="*^|$~".split(""),e={},r={},i=0;t.length>i;i+=1)e[t[i]]=!0;for(i=0;n.length>i;i+=1)r[n[i]]=!0;return function(t,n){return n?t in r:t in e}}();return{lex:function(t){if(v.init(t),p.tokens=[],t)for(;""!==v.ch;)h();else p.tokens.push(this.white());var n=p.tokens;return p.tokens=null,n},parse:function(t){for(var n,e=this.lex(t),r=0,i=0,a=e.length;a>i;i++)n=e[i],n.start=r,n.end=r+=n.value.length;return e},white:function(){return{value:"",type:"white",start:0,end:0}},toSource:function(t){for(var n=0,e=t.length,r="";e>n;n++)r+=t[n].value;return r}}}),e("range",["lodash"],function(t){function n(t,n,e){switch(e){case"eq":case"==":return t===n;case"lt":case"<":return n>t;case"lte":case"<=":return n>=t;case"gt":case">":return t>n;case"gte":case">=":return t>=n}}function e(n,e){"object"==typeof n&&"start"in n?(this.start=Math.min(n.start,n.end),this.end=Math.max(n.start,n.end)):t.isArray(n)?(this.start=n[0],this.end=n[1]):(e="string"==typeof n?e.length:+e,this.start=n,this.end=n+e)}return e.prototype={length:function(){return this.end-this.start},equal:function(t){return this.cmp(t,"eq","eq")},shift:function(t){return this.start+=t,this.end+=t,this},overlap:function(t){return t.start<=this.end&&t.end>=this.start},intersection:function(t){if(this.overlap(t)){var n=Math.max(t.start,this.start),r=Math.min(t.end,this.end);return new e(n,r-n)}return null},union:function(t){if(this.overlap(t)){var n=Math.min(t.start,this.start),r=Math.max(t.end,this.end);return new e(n,r-n)}return null},inside:function(t){return this.cmp(t,"lte","gt")},contains:function(t){return this.cmp(t,"lt","gt")},include:function(t){return this.cmp(t,"lte","gte")},cmp:function(t,r,i){var a,u;return t instanceof e?(a=t.start,u=t.end):a=u=t,n(this.start,a,r||"<=")&&n(this.end,u,i||">")},substring:function(t){return this.length()>0?t.substring(this.start,this.end):""},clone:function(){return new e(this.start,this.length())},toArray:function(){return[this.start,this.end]},toString:function(){return this.valueOf()},valueOf:function(){return"{"+this.start+", "+this.length()+"}"}},{create:function(t,n){return t===void 0||null===t?null:t instanceof e?t:("object"==typeof t&&"start"in t&&"end"in t&&(n=t.end-t.start,t=t.start),new e(t,n))},create2:function(n,e){return t.isNumber(n)&&t.isNumber(e)&&(e-=n),this.create(n,e)}}}),e("tree",["lodash","cssParser","range"],function(t,n,e){function r(t,n,e){e=e||{},this.nameRange=t,this.valueRange=n,this.children=[],this.parent=null,this.type=e.type||"section",this._name=null,this._nameLower=null,this._value=null,this._hints=e}function i(t,n){this.tokens=t,this.len=t.length,this.source=n,this.start=this.pos=0,this.root=new r(null,null,{type:"root",startToken:0,endToken:this.len-1}),this.root._source=n,this.root.tokens=t,this.ctx=this.root}function a(n,e){var r=function(t,n){t[n]>=e.tokenStart&&(t[n]+=e.tokenOffset,0>t[n]&&(t[n]=0))};t.each(n,function(t){var n=t._hints;r(n,"startToken"),r(n,"endToken"),n.name&&(r(n.name,0),r(n.name,1));var i=t.nameRange;t.nameRange&&(i.start>=e.charStart&&(i.start+=e.charOffset),i.end>=e.charStart&&(i.end+=e.charOffset)),t.valueRange&&(i=t.valueRange,i.start>=e.charStart&&(i.start+=e.charOffset),i.end>=e.charStart&&(i.end+=e.charOffset))})}function u(t){return t.trim().replace(p," ")}function o(e){var r=t.isArray(e)?e:n.lex(e);r=t.filter(r,function(t){return"comment"!==t.type});for(var i,a="",o=[],c=0,s=r.length;s>c;c++)i=r[c],","===i.type?(o.push(u(a)),a=""):a+="line"===i.type?" ":i.value;return o.push(u(a)),t.compact(o)}function c(t){return l(t,v)}function s(t){return l(t,d)}function l(t,n){for(var e,r=!1;(e=t.peek())&&e.type in n;)r=!0,t.next();return r}function f(t){c(t);var n=function(){return[t.start,t.pos]};t.start=t.pos;for(var i,a,u,o;i=t.peek();)if("@"===i.type){if(t.start=t.pos,t.skipTo(g),";"===t.peek().type){var l=t.curRange(!0),h=l.substring(t.source),p=h.match(/^@?\w+/)[0],v=l.start;l.start+=p.length;var d={startToken:t.start,endToken:t.pos};t.ctx.addChild(new r(e.create2(v,l.start),l,d)),t.next(),c(t),t.start=t.pos;continue}}else if("{"===i.type||":"===i.type)if(a=t.curRange(!0),o=n(),t.next(),"{"===i.type){i.start;var y=t.ctx.addChild(new r(a,null,{name:o,startToken:o[0]}));t.ctx=y,f(t),t.ctx=t.ctx.parent;var b,_;t.peek()?(b=t.peek().end,_=t.pos):(_=t.tokens.length-1,b=t.tokens[_].end),y.valueRange=e.create2(i.start,b),y._hints.endToken=_,t.next(),c(t),t.start=t.pos}else{for(var k,x=t.pos,C=!1;k=t.next();){if("{"===k.type){t.backUp(1),C=!0;break}if(";"===k.type||"}"===k.type){t.pos=x;break}}if(C)continue;t.start=t.pos,t.skipTo(m),u=t.curRange(!0);var _=t.pos;"}"===t.peek().type&&_--,t.ctx.addChild(new r(a,u,{type:"property",name:o,startToken:o[0],endToken:_})),";"===t.peek().type&&t.next(),c(t),t.start=t.pos}else{if("}"===i.type)return t.next(),s(t),t.backUp(1),void 0;t.next()}}function h(n){var e=0;if(t.each(n,function(t){"{"===t.type?e++:"}"===t.type&&e--}),e)throw"Invalid CSS structure"}var p=/[ \t]+/g,v={white:!0,line:!0,comment:!0},d={white:!0,line:!0},g={";":!0,"{":!0},m={";":!0,"}":!0},y={start:0,end:0};return r.prototype={addChild:function(t){return t.parent=this,this.children.push(t),t},rawName:function(){return this.nameRange?this.nameRange.substring(this.source()):""},name:function(n){return null===this._name&&(this._name=o(this._nameTokens()||this.rawName()).join(", ").trim(),"property"===this.type&&(this._name=t.last(this._name.split(/\s+/)))),n?(null===this._nameLower&&(this._nameLower=this._name.toLowerCase()),this._nameLower):this._name
},rawValue:function(){return this.valueRange?this.valueRange.substring(this.source()):""},value:function(){return this._value||(this._value=this.rawValue().trim()),this._value},valueOf:function(t){t=t||"";var n="";return this.children.forEach(function(e){n+=t+"(n)"+e.name(),n+=e.children.length?"\n"+e.valueOf(t+"	"):": (v)"+e.value()+"\n"}),n},root:function(){if(!this.parent)return this;for(var t=this.parent;t.parent;)t=t.parent;return t},properties:function(){var n=[],e=-1;return t.each(this.children,function(t){"property"==t.type&&n.push({name:t.name().trim(),value:t.value().trim(),index:++e})}),n},_nameTokens:function(){var t=this._hints.name;return t?this.root().tokens.slice(t[0],t[1]):void 0},range:function(){if(!this.parent)return e.create2(0,this.source);var t=this.nameRange.start,n=this.valueRange?this.valueRange.end:this.nameRange.end;return e.create2(t,n)},fullRange:function(){var t=this._hints,n=this.root().tokens;if(n&&"startToken"in t&&"endToken"in t){var r=n[t.startToken],i=n[t.endToken];return e.create2(r.start,i.end)}},toSource:function(){return this.range().substring(this.source()).trim()},toFullSource:function(){return this.fullRange().substring(this.source())},source:function(){var t=this.root();return t._dirty&&(t._source=n.toSource(t.tokens),t._dirty=!1),t._source},toJSONCache:function(){if(!this.parent)return this.children.map(function(t){return t.toJSONCache()});var t={name:this.name(),value:this.value(),type:this.type};return"property"==this.type?t.value=this.value():t.children=this.children.map(function(t){return t.toJSONCache()}),t},all:function(){var t=[],n=function(e){for(var r=0,i=e.children.length;i>r;r++)t.push(e.children[r]),n(e.children[r])};return n(this),t},_allSiblings:function(){for(var n,e=[],r=this,i=function(t){e.push(t);for(var n=0,r=t.children.length;r>n;n++)i(t.children[n])};r.parent;){n=r.parent.children;for(var a=t.indexOf(n,r)+1,u=n.length;u>a;a++)i(n[a]);r=r.parent,r&&e.push(r)}return e},index:function(){return this.parent?this.parent.children.indexOf(this):0},remove:function(){if(this.parent){var t=this._hints.startToken,n=this._hints.endToken,e=n-t+1,r=this.root().tokens,i=r[t].start,u=r[n].end,o=u-i,c=this._allSiblings(),s=this.index();this.parent.children.splice(s,1),a(c,{tokenStart:t,tokenOffset:-e,charStart:i,charOffset:-o}),r.splice(t,e);for(var l,f=t,h=r.length;h>f;f++)l=r[f],l.start-=o,l.end-=o;this.root()._dirty=!0}},insert:function(n,e){t.isUndefined(e)&&(e=this.children.length);var r,i=this.root().tokens,u=null;if(this.parent||0!==e)if(this.children[e])r=this.children[e]._allSiblings(),r.unshift(this.children[e]),u=this.children[e]._hints.startToken;else{if(this.parent){for(u=this._hints.endToken;u>=0&&"}"!==i[u].type;)u--;if(this._hints.startToken>=u)throw"Invalid CSS section"}else u=this._hints.endToken+1;r=this._allSiblings()}else u=this.children.length?0:i.length;if(null===u||t.isUndefined(u))throw"Unable to insert subtree: target token is unavailable";var o,c=0;o=u>=i.length?(t.last(i)||y).end:i[u].start;for(var s=t.map(n.tokens,function(n){return n=t.clone(n),n.start+=o,n.end+=o,c+=n.value.length,n}),l=u,f=i.length;f>l;l++)i[l].start+=c,i[l].end+=c;a(n.all(),{tokenStart:0,tokenOffset:u,charStart:0,charOffset:u&&i[u-1]?i[u-1].end:0}),a(r,{tokenStart:u,tokenOffset:s.length,charStart:o,charOffset:c}),s.unshift(u,0),i.splice.apply(i,s),this.children.splice.apply(this.children,[e,0].concat(n.children));var h=this;n.children.forEach(function(t){t.parent=h});var p=this.root();p._hints.endToken=i.length-1,p._dirty=!0},replace:function(t){var n=this.index(),e=this.parent;return this.remove(),e.insert(t,n)}},i.prototype={hasNext:function(){return this.pos<this.len},next:function(){return this.tokens[this.pos++]},peek:function(){return this.tokens[this.pos]},curRange:function(t){var n=this.tokens[this.start];return e.create2(n.start,this.peek()[t?"start":"end"])},backUp:function(t){this.pos-=t},skipTo:function(t){for(;++this.pos<this.len&&!(this.tokens[this.pos].type in t););}},{build:function(e){var r;t.isString(e)?r=n.parse(e):(r=e,e=n.toSource(r)),h(r);for(var a=new i(r,e);a.hasNext();)f(a);return a.root},fromJSONCache:function(n,e){return t.isString(n)&&(n=JSON.parse(n)),e=e||new r(null,null,{type:"root"}),t.each(n,function(t){var n=new r;n._name=t.name,n._value=t.value,n.type=t.type,e.addChild(n),t.children&&this.fromJSONCache(t.children,n)},this),e},parseSelectors:o,CSSNode:r,TokenIterator:i}}),e("locator",["lodash","tree"],function(t,e){function r(t){if(!t.parent)return null;if(!t.__sectionPath){for(var n=t.name(),e=n.toLowerCase(),r=t.parent.children,i=1,a=0,u=r.length;r[a]!==t&&u>a;a++)r[a].name(!0)===e&&i++;t.__sectionPath=[n,i]}return t.__sectionPath}function i(n,e){if(e=t.extend({syntax:"css"},e||{}),"scss"==e.syntax){for(var r,i=[],a=n;a.parent;){if(r=n.name(),/^@media/i.test(r)){if(!i.length)return r;break}i.push(n.name()),a=a.parent}return i.join(" ")}return n.name()}function a(t){for(var n,e=[];n=t.pop();)"&"==n.charAt(0)?e.push(t.pop()+n.substr(1)):e.push(n);return e.reverse().join(" ")}if("undefined"==typeof emmet)try{emmet=n("vendor/emmet")}catch(u){}return{stringifyPath:function(n,e){return t.isString(n)?n:n.map(function(t){return t[0]+(!e&&t[1]>1?"|"+t[1]:"")}).join("/")},createPath:function(n,e){if(t.isObject(e)||(e={asString:!!e}),!n.__path){for(var i=[];n.parent;)i.push(r(n)),n=n.parent;if(i=i.reverse(),"scss"==e.syntax){for(var u,o=[],c=[],s=/^@media/i;u=i.shift();)s.test(u[0])?(c.length&&(o.push([a(c),1]),c=[]),o.push(u)):c.push(u[0]);c.length&&o.push([a(c),1]),i=o}n.__path=i}return e.asString?this.stringifyPath(n.__path):n.__path},parsePath:function(n){if(!t.isString(n))return n;if("["==n.charAt(0)||"{"==n.charAt(0))return JSON.parse(n);for(var e,r,i,a=[],u=/\|(\d+)$/,o=emmet.require("stringStream").create(n);r=o.next();)switch(r){case"/":e=o.current().trim(),a.push(e.substring(0,e.length-1).trim()),o.start=o.pos;break;case'"':case"'":for(;i=o.next();)if("\\"==i)o.next();else if(i==r)break}return a.push(o.current().trim()),t.compact(a).map(function(t){var n=1;return t=t.replace(u,function(t,e){return n=+e,""}),[t,n]})},normalizePath:function(t){return this.parsePath(t).map(function(t){return[e.parseSelectors(t[0]).join(", "),t[1]]})},locate:function(n,e,r){if(r=r||{},"scss"==r.syntax)return this.locateSCSS(n,e);e=this.normalizePath(e);for(var a,u,o,c=n;(u=e.shift())&&(o=u[0].toLowerCase(),a=t.filter(c.children,function(t){var n=i(t,r);return n==u[0]||n.toLowerCase()==o}),c=a[u[1]-1]););return c},locateSCSS:function(t,n){n=this.normalizePath(n);for(var e,r,i=this,a={syntax:"scss"},u=t.all().map(function(t){return{path:i.createPath(t,a),node:t}}),o=0;e=n.shift();){if(r=e[0].toLowerCase(),u=u.filter(function(t){return t.path[o]?t.path[o][0].toLowerCase()==r:void 0}),!u[e[1]-1]){u=null;break}u=[u[e[1]-1]],o++}return u&&u[0]?u[0].node:null},guessLocation:function(n,e){e=this.normalizePath(e);for(var r,i,a=function(n,e){return t.isArray(e)&&(e=e[0]),n.filter(function(t){return t.name()==e})},u=n;r=e.shift();){var o=this.locate(u,[r]);if(o||(i=a(u.children,r),i.length&&(e[0]&&(o=t.last(i.filter(function(t){return a(t.children,e[0]).length}))),o||(o=t.last(i)))),!o){e.unshift(r);break}u=o}return{found:u!==n,node:u,rest:e.length?e:null}},locateByPos:function(t,n){for(var e,r=0,i=t.children.length;i>r;r++)if(e=t.children[r],e.range().include(n))return this.locateByPos(e,n)||e}}}),e("diff",["lodash","tree","locator"],function(t,n,e){function r(t){return t instanceof n.CSSNode?t:n.build(t)}function i(t,n){if(n=n||[],t&&t.children)for(var e,r=0,a=t.children.length;a>r;r++)e=t.children[r],"property"!=e.type&&(n.push(e),i(e,n));return n}function a(n,r){return n instanceof Array||(n=i(n)),t.map(n,function(t){var n=e.createPath(t,r);return{path:n,pathString:e.stringifyPath(n,!0),section:t}})}function u(n){return n=t.isString(n)?n.toLowerCase():n.name().toLowerCase(),n in l}function o(n,e){var r=n.properties(),i=e.properties(),a=[],u=[],o=[],c=0;return t.each(i,function(t){var n=r[c];if(!n)return a.push(t);if(t.name===n.name)return++c,t.value!==n.value&&u.push(t),void 0;for(var e=c+1,i=r.length;i>e;e++)if(r[e].name===t.name&&r[e].value===t.value)return o=o.concat(r.slice(c,e)),c=e+1,void 0;a.push(t)}),o=o.concat(r.slice(c,r.length)),0===a.length+u.length+o.length?null:{added:a,updated:u,removed:o}}function c(t,n){if(u(t))return t.value()==n.value();var e=t.properties(),r=n.properties();if(e.length!==r.length)return!1;for(var i=0,a=e.length;a>i;i++)if(e[i].name!==r[i].name||e[i].value!==r[i].value)return!1;return!0}function s(t,n){for(var e,r,i=0,a=n.length;a>i;i++){r=n[i];for(var e,u=0,o=t.length;o>u;u++)if(e=t[u],e.pathString==r.pathString&&c(e.section,r.section)){t.splice(u,1),n.splice(i,1),a--,i--;break}}}var l={"@import":!0,"@charset":!0};return{diff:function(n,e,i){i=t.extend({syntax:"css"},i||{});var c=r(n,i),l=r(e,i),f=a(c,i),h=a(l,i),p=[];return s(f,h),t.each(h,function(n){var e=t.find(f,function(t){return t.pathString==n.pathString}),r={path:n.path,action:e?"update":"add"};if(u(n.section)&&(r.value=n.section.value()),"update"==r.action){if(!("value"in r)){var i=o(e.section,n.section);r.properties=i.added.concat(i.updated),r.removed=i.removed}f=t.without(f,e)}else"value"in r||(r.properties=n.section.properties());p.push(r)}),t.each(f,function(t){p.push({path:t.path,action:"remove"})}),p},diffSections:o,shouldCompareValues:u}}),e("patch",["lodash","tree","locator","diff","cssParser"],function(t,e,r,i){function a(t,n,e){return t+e.selSep+"{"+e.indent+n+e.end+"}"}function u(n){var e,r=t.clone(h);"property"==n.type&&(n=n.parent);for(var i,a=function(t){for(var n=0,e=t.children.length;e>n;n++)if("property"==t.children[n].type)return!0;return!1},u=n;u=u.parent;)if(i=t.find(u.children,a)){u=i;break}if(u||(u=t.find(n.all(),a)),u&&u.parent){r.selSep=u.rawName().match(/([\s\n\r]+)$/)?RegExp.$1:"";try{e=emmet.require("cssEditTree").parse(u.toSource())}catch(o){}}if(e){var c=t.last(e.list());c&&(r.indent=c.styleBefore,r.sep=c.styleSeparator,r.end=e.source.substring(c.fullRange().end,e.source.length-1))}return r}function o(t,n){if(n=n.toLowerCase(),"@charset"==n)return 0;if("@import"==n){for(var e,r=0,i=t.children.length;i>r;r++)if(e=t.children[r].name().toLowerCase(),"@charset"!=e&&"@import"!=e)return r;return 0}return t.children.length}function c(n,c,s){var f=r.guessLocation(n,c);if(f.node.parent){var h=f.node.name().toLowerCase();"@import"==h&&"add"==s.action&&(f.rest||(f.rest=[]),f.rest.unshift([h]),f.node=f.node.parent)}if(f.rest){var p="",v=u(f.node),d=emmet.require("utils"),g=f.rest[0][0],m=f.rest.pop();i.shouldCompareValues(m[0])&&"value"in s?p=m[0]+" "+s.value+";":(p=a(m[0],"",t.defaults({indent:""},v)),p=l(e.build(p).children[0],s,v));for(var y=v.indent.match(/([ \t]+)$/)?RegExp.$1:"",b=f.rest.length-1;b>=0;b--)p=a(f.rest[b][0],d.padString(p,y),v);var _=o(f.node,g),k=f.node.children.length;k&&_!==k?p+=v.sectionSep:k&&(p=v.sectionSep+p),f.node.insert(e.build(p),_)}else{var x=l(f.node,s);f.node.replace(e.build(x))}}function s(t,n){var e,r=t.toFullSource(),i=t.rawValue(),a=t.fullRange().start,u=t.valueRange.start-a,o=t.valueRange.end-a;(e=i.match(p))&&(u+=e[0].length),(e=i.match(v))&&(o-=e[0].length);var c=i?"":" ",s=r.substring(0,u)+c+n.value+r.substring(o);return s}function l(n,e,r){if("value"in e)return s(n,e);r=r||u(n);var i=emmet.require("cssEditTree").parse(n.toFullSource(),{styleBefore:r.indent,styleSeparator:r.sep});return t.each(e.properties,function(n){var e;"index"in n&&(e=i.get(n.index),e&&e.name()==n.name||(e=t.last(i.getAll(n.name)))),e?e.value(n.value):i.value(n.name,n.value)}),t.each(e.removed,function(t){i.remove(t.name)}),i.source}if("undefined"==typeof emmet)try{emmet=n("vendor/emmet")}catch(f){}var h={selSep:" ",sectionSep:"\n",indent:"\n	",sep:": ",end:"\n"},p=/^\s+/,v=/\s+$/;return{condense:function(n){var e={},i=function(t,n){for(var e=0,r=t.length;r>e;e++)if(t[e].name===n)return t[e]};return t.each(n,function(t){var n=r.stringifyPath(t.path);n in e||(e[n]=[]),e[n].push(t)}),t.map(e,function(n){var e=t.cloneDeep(n[0]);return t.each(t.rest(n),function(n){return"remove"==n.action||"remove"==e.action?e=n:(e.action="update",e.removed=t.filter(e.removed,function(t){return!i(n.properties,t.name)}),e.properties=e.properties.concat(t.filter(n.properties,function(t){var n=i(e.properties,t.name);return n?(n.value=t.value,!1):!0})),e.removed=e.removed.concat(t.filter(n.removed,function(t){return!i(e.removed,t.name)})),void 0)}),e})},patch:function(n,i,a){i=this.condense(t.isArray(i)?i:[i]);var u=t.isString(n)?e.build(n):n;return t.each(i,function(t){var n=r.parsePath(t.path),i=r.locate(u,n,a);if("remove"===t.action)return i&&i.remove(),void 0;if(i){var o=l(i,t);i.replace(e.build(o))}else c(u,n,t)}),u.source()},learnStyle:u}}),e("backend/sublimetext",["diff","patch","tree","locator"],function(t,n,e,r){function i(t){return"string"==typeof t?JSON.parse(t):t}function a(t){return t&&"ParseError"==t.name?t.message:t}function u(a,u,o){var c,s=e.build(a),l=e.fromJSONCache(s.toJSONCache());if(u=i(u||[]),u&&u.length&&(c=n.patch(a,u,{syntax:o||"css"})),c){for(var f,h=t.diff(l,s),p=null,v=0,d=h.length;d>v;v++)if(f=h[v],"remove"!=f.action){var g=r.locate(s,f.path);if(g){if(f.properties.length){var m=f.properties[0],y=r.locate(g,[[m.name,(m.index||0)+1]]);if(y){p=y.valueRange.toArray(),y.rawValue().match(/^(\s+)/)&&(p[0]+=RegExp.$1.length);break}}p=[g.nameRange.start,g.nameRange.start];break}}return{content:c,selection:p}}}return{diff:function(n,e,r){var i=null,u=null;try{u=t.diff(n,e,{syntax:r||"css"})}catch(o){i=o}return JSON.stringify({status:i?"error":"ok",patches:u,error:a(i)})},condensePatches:function(t,e){t=i(t||[]),e=i(e||[]);var r=n.condense(t.concat(e));return r.length?JSON.stringify(r):null},patch:function(t,e,r){return e=i(e||[]),e&&e.length?n.patch(t,e,{syntax:r||"css"}):void 0},patchAndDiff:function(t,n,e){var r=null;try{r=u(t,n,e),r.status="ok"}catch(i){r={status:"error",error:a(i)}}return JSON.stringify(r)}}}),n("backend/sublimetext")});